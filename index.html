<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>CHINACNU 所有价格表（完整显示）</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background: #f5f5f5; }
    h1 { color: #1a73e8; }
    h2 { color: #333; margin-top: 40px; }
    .table-wrapper {
      overflow-x: auto;
      background: white;
      padding: 10px;
      margin-bottom: 40px;
      border-radius: 6px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    table {
      border-collapse: collapse;
      white-space: nowrap;
      width: max-content;
      min-width: 100%;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 6px 10px;
      text-align: center;
    }
    th {
      background-color: #eee;
      font-weight: bold;
    }
    .error {
      color: red;
    }
    .nav {
      background: white;
      padding: 10px;
      margin-bottom: 30px;
      border-radius: 6px;
      box-shadow: 0 1px 4px rgba(0,0,0,0.1);
    }
    .nav a {
      margin-right: 15px;
      text-decoration: none;
      color: #1a73e8;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h1>CHINACNU 实时价格表</h1>

  <div class="nav" id="nav"></div> <!-- 顶部导航目录 -->

  <div id="tables"></div>

  <script>
    const sheetId = "1L8RGRPI7BdIlDew99K7QIXU5f7llOLqWqskwXb1lms4";
    const apiKey = "AIzaSyB-io6C9S0y5I6YXMi9TrDbAx8PkC2ReKo";
    const range = "A1:Z100";
    const sheetNames = [
      "涨跌记录",
      "彩涂板(新增)",
      "有花镀锌 厚板",
      "有花镀锌 (薄板)带精包",
      "彩基板",
      "镀铝锌无耐指纹",
      "彩涂漆膜12-5",
      "罩退冷轧卷板",
      "热卷价格",
      "镀锌带钢",
      "国际型钢",
      "中国型钢"
    ];

    const container = document.getElementById("tables");
    const nav = document.getElementById("nav");

    // ⬆️ 生成导航目录
    sheetNames.forEach(sheetName => {
      const link = document.createElement("a");
      link.href = `#${sheetName}`;
      link.textContent = sheetName;
      nav.appendChild(link);
    });

    // ⬇️ 加载每个工作表内容
    sheetNames.forEach(sheetName => {
      const encodedName = encodeURIComponent(sheetName);
      const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/'${encodedName}'!${range}?key=${apiKey}`;

      fetch(url)
        .then(res => res.json())
        .then(data => {
          const section = document.createElement("div");
          section.id = sheetName; // 设置锚点

          const title = document.createElement("h2");
          title.textContent = sheetName;
          section.appendChild(title);

          if (!data.values || data.values.length === 0) {
            const error = document.createElement("p");
            error.className = "error";
            error.textContent = "⚠️ 表格中无数据或加载失败";
            section.appendChild(error);
            container.appendChild(section);
            return;
          }

          // ✅ 全部列都显示（不隐藏）
          const visibleIndexes = data.values[0].map((_, i) => i);

          const wrapper = document.createElement("div");
          wrapper.className = "table-wrapper";
          const table = document.createElement("table");
          const thead = document.createElement("thead");
          const tbody = document.createElement("tbody");

          const headerRow = document.createElement("tr");
          visibleIndexes.forEach(i => {
            const th = document.createElement("th");
            th.textContent = data.values[0][i];
            headerRow.appendChild(th);
          });
          thead.appendChild(headerRow);
          table.appendChild(thead);

          for (let i = 1; i < data.values.length; i++) {
            const row = document.createElement("tr");
            visibleIndexes.forEach(j => {
              const td = document.createElement("td");
              td.textContent = data.values[i][j] || "";
              row.appendChild(td);
            });
            tbody.appendChild(row);
          }

          table.appendChild(tbody);
          wrapper.appendChild(table);
          section.appendChild(wrapper);
          container.appendChild(section);
        })
        .catch(err => {
          const errorSection = document.createElement("div");
          errorSection.innerHTML = `<h2>${sheetName}</h2><p class="error">❌ 加载失败：${err.message}</p>`;
          container.appendChild(errorSection);
        });
    });
  </script>
</body>
</html>
