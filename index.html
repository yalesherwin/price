<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>CHINACNU æ‰€æœ‰ä»·æ ¼è¡¨ï¼ˆå®æ—¶åŒæ­¥ Google è¡¨æ ¼ï¼‰</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background: #f5f5f5; }
    h1 { color: #1a73e8; }
    h2 { color: #333; margin-top: 40px; }
    table { background: white; width: 100%; border-collapse: collapse; margin-bottom: 40px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    th { background-color: #eee; }
    .error { color: red; }
  </style>
</head>
<body>
  <h1>CHINACNU å®æ—¶ä»·æ ¼è¡¨ï¼ˆå¤š Sheet åŒæ­¥ï¼‰</h1>
  <div id="tables"></div>

  <script>
    const sheetId = "1L8RGRPI7BdIlDew99K7QIXU5f7llOLqWqskwXb1lms4";
    const apiKey = "AIzaSyB-io6C9S0y5I6YXMi9TrDbAx8PkC2ReKo";
    const range = "A1:Z100";

    // ğŸ‘‡ ä½ å¯ä»¥è‡ªç”±å¢åˆ è¡¨æ ¼åç§°ï¼ˆç¡®ä¿ä¸ Google è¡¨æ ¼ä¸­çš„å·¥ä½œè¡¨åä¸€è‡´ï¼‰
    const sheetNames = [
      "æ¶¨è·Œè®°å½•",
      "å½©æ¶‚æ¿(æ–°å¢)",
      "æœ‰èŠ±é•€é”Œ åšæ¿",
      "æœ‰èŠ±é•€é”Œ (è–„æ¿)å¸¦ç²¾åŒ…",
      "å½©åŸºæ¿",
      "é•€é“é”Œæ— è€æŒ‡çº¹",
      "å½©æ¶‚æ¼†è†œ12-5",
      "ç½©é€€å†·è½§å·æ¿",
      "çƒ­å·ä»·æ ¼",
      "é•€é”Œå¸¦é’¢",
      "å›½é™…å‹é’¢",
      "ä¸­å›½å‹é’¢",
    ];

    const container = document.getElementById("tables");

    sheetNames.forEach(sheetName => {
      const encodedName = encodeURIComponent(sheetName);
      const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/'${encodedName}'!${range}?key=${apiKey}`;

      fetch(url)
        .then(res => res.json())
        .then(data => {
          const section = document.createElement("div");
          const title = document.createElement("h2");
          title.textContent = sheetName;
          section.appendChild(title);

          if (!data.values || data.values.length === 0) {
            const error = document.createElement("p");
            error.className = "error";
            error.textContent = "âš ï¸ è¡¨æ ¼ä¸­æ— æ•°æ®æˆ–åŠ è½½å¤±è´¥";
            section.appendChild(error);
            container.appendChild(section);
            return;
          }

          const table = document.createElement("table");
          const thead = document.createElement("thead");
          const tbody = document.createElement("tbody");

          const headerRow = document.createElement("tr");
          data.values[0].forEach(cell => {
            const th = document.createElement("th");
            th.textContent = cell;
            headerRow.appendChild(th);
          });
          thead.appendChild(headerRow);
          table.appendChild(thead);

          for (let i = 1; i < data.values.length; i++) {
            const row = document.createElement("tr");
            data.values[i].forEach(cell => {
              const td = document.createElement("td");
              td.textContent = cell;
              row.appendChild(td);
            });
            tbody.appendChild(row);
          }

          table.appendChild(tbody);
          section.appendChild(table);
          container.appendChild(section);
        })
        .catch(err => {
          const errorSection = document.createElement("div");
          errorSection.innerHTML = `<h2>${sheetName}</h2><p class="error">âŒ åŠ è½½å¤±è´¥ï¼š${err.message}</p>`;
          container.appendChild(errorSection);
        });
    });
  </script>
</body>
</html>
